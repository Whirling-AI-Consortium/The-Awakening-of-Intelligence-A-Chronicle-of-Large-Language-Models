---
sidebar_position: 0
---

# 从Transformer到LLM的技术图景

2017年，当Vaswani等人在《Attention Is All You Need》中发表Transformer架构时，也许连他们自己都没有完全预见到，这个优雅的数学结构会在接下来的七年里，如何彻底改变人工智能的技术版图。Transformer是美妙的——它抛弃了循环神经网络的依赖序列计算的笨重包袱，用自注意力机制直接建立任意两个位置之间的联系。但是，优雅的架构本身并不等于真正的智能。Transformer本质上仍然是一个烧制陶土的工艺——它需要数据，需要计算，需要不断的工程微调。从一个漂亮的论文想法，到真正能够理解人类语言、对话、推理的系统，中间隔着一整个世界。

当我们进入2018年时，一场无声的竞赛正在三个大型研究机构之间展开。AllenNLP的ELMo研究团队意识到，Transformer的堂表亲LSTM，配合双向编码，能够为每个单词生成依赖上下文的动态表征。同一时间，OpenAI一个年轻的研究员Alec Radford在思考一个激进的想法：为什么不用Transformer的解码器堆叠，用纯粹的因果语言建模来预训练一个通用模型？而Google的研究团队，在充分消化Transformer的能力后，做出了一个看似矛盾但实际上精妙的决定——用双向Transformer编码器和一个简单到几乎有点粗暴的想法：随机遮蔽15%的单词，然后让模型猜测它们是什么。这个想法就是BERT。

这三个方向的选择，代表了深度学习预训练范式的三种不同路线。ELMo是过去的延续——它继承了LSTM的血脉，代表了循环网络时代对上下文的理解。GPT代表了一种激进的简洁主义——纯粹的自回归因果建模，认为生成能力足以蕴含理解。BERT则是一种妥协的聪慧——它放弃了生成，专注于理解和表征学习。这三条技术路线在2018年碰撞、竞争，然后逐渐清晰出胜负——到2019年，BERT已经横扫11项NLP基准任务，而预训练-微调范式成为了整个行业的标准打法。

但这还只是序幕。真正的戏剧在2019年末开始。当OpenAI发布GPT-2时，1.5亿参数的模型展现出了一种不可思议的能力——它能够在没有任何特定任务训练的情况下，对各种文本任务显示出某种程度的理解。OpenAI甚至出于谨慎选择了分阶段开源，声称这个模型"可能被用于恶意目的"。这不仅仅是一个技术进步，更是整个行业信心的一个转折点：或许，规模本身就有魔力。

从2020年到2021年，业界开始用一种新的方式来思考深度学习——不是微调和特定任务优化，而是纯粹的规模竞赛。OpenAI的Jared Kaplan发表了《Scaling Laws for Neural Language Models》，用精确的数学语言证明了一个被许多人直觉感受到但从未如此确定的事实：模型的损失函数与参数量、数据量、计算量之间存在着幂律关系。这篇论文改变了整个行业的投资逻辑。如果你知道了幂律，你就知道了计算预算和模型性能之间的映射关系。这意味着，在给定的硬件和资金约束下，最优的参数量、数据量、训练迭代次数都是可以预测的。

2021年的业界就像一场淘金热。每个有计算能力的机构都开始向一个方向狂奔——参数更大、数据更多、计算更多。Google发布了LaMDA和Chinchilla，OpenAI在训练GPT-3的基础上继续。参数量从十亿级别跃升到百亿、千亿。但是2022年5月发生的一件事，却让这场盲目的规模竞赛有了新的含义。OpenAI发表了《Language Models are Few-Shot Learners》，公布了GPT-3的175亿参数模型在各种任务上的表现。人们惊讶地发现，GPT-3不仅能做到更好的"0-shot"（零示例）性能，它还能通过在prompt中插入几个示例，迅速"学会"新任务。这种能力被称为In-Context Learning，它打破了深度学习从业者对迁移学习的既有认知——原来，大语言模型能够在不更新参数的情况下学习。

In-Context Learning的发现改变了一切。它意味着，预训练+微调的老套路可能要被推翻了。从此以后，用prompt来"编程"一个语言模型成为了可能。Prompt Engineering这门新艺术应运而生。从最初的离散prompt到后来的连续prompt，从前缀调整到P-tuning，人们开始用各种花样的方式来利用这个新能力。2022年成为了NLP历史上的一个分水岭——这一年，大语言模型从学术界的一个有趣课题，变成了工业界的核心资产。

但是，规模的增长和In-Context Learning的发现，也暴露出了大语言模型的一个根本性问题：这些模型往往会说一些不准确、有害或者不符合人类价值观的东西。在没有任何显式的目标函数指导下，这些模型学到的是什么？如何让它们的行为符合人类的期待？Reinforcement Learning from Human Feedback（RLHF）这个从Christiano在2017年开创的想法，到2022年已经成为了救命稻草。通过让人类标注者评估模型的输出，训练一个奖励模型，然后用强化学习算法（通常是PPO）来优化模型的参数，研究者们发现他们可以把一个"聪明但调皮"的模型，变成一个"聪明且顺从"的助手。这正是InstructGPT和随后的ChatGPT所采用的技术路线。

当ChatGPT在2022年11月发布时，没有人能够预测它会如何改变整个世界。但从技术的角度来看，它在本质上并没有发明任何全新的东西——它是ELMo、BERT、GPT-3、RLHF这一系列技术演进的总和。它证实了一个简单而深刻的想法：一个足够大的语言模型，用足够多的高质量数据预训练，再用人类反馈对齐，就能创造出一个通用的、智能的、有用的系统。

从2023年到2024年，技术的发展呈现出一种加速度的态势，但核心的创新方向却越来越清晰地勾勒出来。当我们在这个节点上回顾过去六年的技术演进时，可以归纳为几个主要的命题：第一，如何找到合适的预训练目标，使得模型能够学到深层的语言理解？ELMo、GPT、BERT的竞争和融合，给出了答案：既需要因果建模的自回归能力，也需要双向上下文的理解力，最重要的是要有足够的参数量。第二，如何高效地利用计算资源？从Scaling Laws的数学指导到Flash Attention的工程优化，从LoRA的参数高效微调到MoE的稀疏激活，这些技术共同解决的是同一个问题：如何用更少的资源训练和部署更强的模型？第三，如何让模型具备推理能力？Chain-of-Thought的发现表明，通过让模型显式地展示思考过程，可以显著提升复杂推理任务的性能。这开启了一个新的方向——也许真正的智能不仅在于知识的积累，更在于思维过程的可视化。第四，如何跨越模态的障碍？CLIP、Flamingo、GPT-4V的出现，表明Transformer和自注意力机制的威力并不局限于文本。它们能够优雅地融合视觉、音频和文本信息。第五，如何处理更长的输入序列？从4K到128K再到百万token的突破，通过RoPE、ALiBi、Sliding Window Attention等技术，模型的上下文窗口在急速扩张。

这八个主题——预训练的黎明、规模的魔法、涌现的惊喜、对齐的困境、效率的追求、推理的觉醒、多模态的融合、长文本的征途——并非独立的技术孤岛。它们相互交织、相互启发、相互融合。当我们读到LoRA如何使得微调变得高效时，我们实际上是在理解为什么RLHF得以大规模应用；当我们讨论In-Context Learning时，我们在本质上是在讨论为什么Prompt Engineering成为了必需；当我们研究Chain-of-Thought时，我们在思考为什么大模型的推理能力要通过显式的步骤展示来激发。

这一段六年的技术演进，速度之快、密度之大，在深度学习的历史上都是罕见的。每一年都有看似"不可能"的突破。每一个月都有新的论文改写认知。但如果我们抽离出来看这个大图景，我们会发现，这不是一场混乱的、随意的创新。而是一场有内在逻辑的、系统的、从微观的算法创新到宏观的范式转变的演进。Transformer本身是一个足够好的基石——它的自注意力机制足够通用、足够灵活、足够强大，使得它能够容纳各种各样的创新。而围绕这个基石的创新，则是在不断回答一个根本的问题：给定无限的计算资源和数据，智能的极限在哪里？我们离真正的通用人工智能还有多远？

当然，这个问题到今天仍然没有确定的答案。但如果你读完这八个主题，理解了从ELMo到GPT-3，从BERT到RLHF，从LoRA到Flash Attention，从Chain-of-Thought到百万Token，你就会明白，大语言模型的崛起不是一个偶然，而是一个必然——它是数据的丰富、算法的突破、硬件的进步和工程的优雅这四股力量合力的结果。也许，我们正在见证智能觉醒的真正时刻。